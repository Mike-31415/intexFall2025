<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Post-Event Surveys</title>
    <link rel="stylesheet" href="/styles.css">
</head>

<body>

    <h1 style="text-align:center;">Post Surveys</h1>

    <%
        // UPDATE: Change check from 'manager' to 'admin'
        let isManager = (participant_role === 'admin' || participant_role === 'Admin' || participant_role === 'A');
    %>

    <% if (isManager) { %>
        <a href="/postsurveys/add" class="btn btn-add">Add Survey</a>
    <% } %>

    <div class="table-scroll-container">
        <table class="event-list">
            <thead>
                <tr>
                    <th>Survey ID</th>
                    <th>Submission Date</th>
                    <th>Satisfaction</th>
                    <th>Usefulness</th>
                    <th>Instructor</th>
                    <th>Recommend</th>
                    
                    <th>Overall Rating</th> 
                    <th>NPS</th>            
                    
                    <th>Comments</th>

                    <% if (isManager) { %>
                        <th>Actions</th>
                    <% } %>
                </tr>
            </thead>

            <tbody>
                <% if (surveys && surveys.length > 0) { %>
                    <% surveys.forEach(survey => { %>
                        <tr>
                            <td><%= survey.surveyid %></td>
                            <td><%= survey.submission_date %></td>
                            <td><%= survey.satisfaction %></td>
                            <td><%= survey.usefulness %></td>
                            <td><%= survey.instructor_rating %></td>
                            <td><%= survey.recommendation %></td>
                            
                            <td><%= survey.rating %></td>
                            <td><%= survey.nps %></td>
                            
                            <td><%= survey.comments %></td>

                            <% if (isManager) { %>
                                <td class="actions">
                                    <a href="/postsurveys/edit/<%= survey.surveyid %>" class="btn btn-edit">Edit</a>
                                    <a href="/postsurveys/delete/<%= survey.surveyid %>" class="btn btn-delete">Delete</a>
                                </td>
                            <% } %>
                        </tr>
                    <% }) %>
                <% } else { %>
                    <tr>
                        <td colspan="<%= isManager ? 10 : 9 %>" style="text-align:center; padding:20px;">
                            No surveys found.
                        </td>
                    </tr>
                <% } %>
            </tbody>
        </table>
    </div>

</body>
</html>